<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>喵星島主控制台</title>
<style>
  :root{
    --text: #0b2a3a;
    --muted: #6b7b88;
    --max-tile-w: 200px;
    --tile-h: 250px;
    --gap: 16px;
    font-family: "Noto Sans TC", "Helvetica Neue", Arial, sans-serif;
  }

  body{
    margin:0;
    background:url("img/bg_sky.png") no-repeat center/cover fixed;
    color:var(--text);
  }

  .wrap{
    max-width:1400px;
    margin:24px auto;
    padding:18px;
  }

  .top-bar{
    display:flex;
    gap:12px;
    align-items:center;
    margin-bottom:12px;
  }

  /* 頭像 */
  .avatar-wrapper{ position:relative; cursor:pointer; }
  .avatar-preview{
    width:56px; height:56px;
    border-radius:50%; overflow:hidden; background:#fff;
  }
  .avatar-preview img{ width:100%; height:100%; object-fit:cover; }
  input[type=file]{ display:none; }

  .player-name-row{
    display:flex; gap:8px; align-items:center;
    font-weight:700; font-size:16px;
  }
  .rename-btn{ background:transparent; border:none; cursor:pointer; }
  .rename-btn img{ width:20px; height:20px; }

  .hint-btn{
    margin-left:12px;
    background:rgba(255,255,255,0.5);
    border:1px solid rgba(0,0,0,0.1);
    padding:4px 8px;
    border-radius:8px;
    cursor:pointer;
  }

  /* 小島矩陣 */
  .islands-grid{
    display:grid;
    grid-template-columns: repeat(5, 1fr); /* 預設電腦版 5 欄 */
    gap: var(--gap);
    justify-items:center;
  }
  .island{ max-width: var(--max-tile-w); text-align:center; }
  .island .title{ font-size:18px; font-weight:700; }
  .island .level{ font-size:13px; color:var(--muted); margin-bottom:6px; }
  .island img{
    width:100%;
    height:var(--tile-h);
    object-fit:cover;
    display:block;
    border-radius:8px;
  }

  /* Modal */
  .modal{
    position:fixed; inset:0; display:none;
    align-items:center; justify-content:center;
    background:rgba(0,0,0,0.35); z-index:9999;
  }
  .modal .box{
    width:clamp(320px, 80%, 720px);
    background:white; padding:18px; border-radius:12px;
  }
  .modal .close{ float:right; cursor:pointer; }

  /* 平板與手機：改為 4 欄 */
  @media (max-width:1200px){
    .islands-grid{ grid-template-columns: repeat(4, 1fr); }
    .island img{ height:auto; } /* 保持等比例縮放 */
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="top-bar">
      <!-- 點擊頭像上傳 -->
      <label class="avatar-wrapper">
        <div class="avatar-preview">
          <img id="avatarImg" src="img/avatar.png" alt="頭像">
        </div>
        <input id="avatarInput" type="file" accept="image/*">
      </label>

      <div>
        <div class="player-name-row">
          <span id="playerName">島主</span>
          <button class="rename-btn" id="renameBtn">
            <img src="img/rename.png" alt="更名">
          </button>
        </div>
      </div>

      <button class="hint-btn" id="hintBtn">?</button>
    </div>

    <!-- 小島 20 個 -->
    <div class="islands-grid">
      <div class="island"><div class="title">飯店島</div><div class="level">LV12</div><a href="i_01_hotel.html"><img src="img/island/island_01.png" alt="飯店島"></a></div>
      <div class="island"><div class="title">餐館島</div><div class="level">LV8</div><a href="i_02_restaurant.html"><img src="img/island/island_02.png" alt="餐館島"></a></div>
      <div class="island"><div class="title">媒體島</div><div class="level">LV20</div><a href="i_03_mediacenter.html"><img src="img/island/island_03.png" alt="媒體島"></a></div>
      <div class="island"><div class="title">研究島</div><div class="level">LV4</div><a href="i_04_researchcenter.html"><img src="img/island/island_04.png" alt="研究島"></a></div>
      <div class="island"><div class="title">證交島</div><div class="level">LV32</div><a href="i_05_stockexchange.html"><img src="img/island/island_05.png" alt="證交島"></a></div>
      <div class="island"><div class="title">總部島</div><div class="level">LV15</div><a href="i_06_headquarters.html"><img src="img/island/island_06.png" alt="總部島"></a></div>
      <div class="island"><div class="title">人事島</div><div class="level">LV7</div><a href="i_07_hrcenter.html"><img src="img/island/island_07.png" alt="人事島"></a></div>
      <div class="island"><div class="title">學院島</div><div class="level">LV2</div><a href="i_08_academy.html"><img src="img/island/island_08.png" alt="學院島"></a></div>
      <div class="island"><div class="title">購物島</div><div class="level">LV24</div><a href="i_09_mall.html"><img src="img/island/island_09.png" alt="購物島"></a></div>
      <div class="island"><div class="title">客服島</div><div class="level">LV9</div><a href="i_10_callcenter.html"><img src="img/island/island_10.png" alt="客服島"></a></div>
      <div class="island"><div class="title">商塔島</div><div class="level">LV18</div><a href="i_11_businesstower.html"><img src="img/island/island_11.png" alt="商塔島"></a></div>
      <div class="island"><div class="title">工廠島</div><div class="level">LV6</div><a href="i_12_factory.html"><img src="img/island/island_12.png" alt="工廠島"></a></div>
      <div class="island"><div class="title">會展島</div><div class="level">LV11</div><a href="i_13_convention.html"><img src="img/island/island_13.png" alt="會展島"></a></div>
      <div class="island"><div class="title">市政島</div><div class="level">LV14</div><a href="i_14_cityhall.html"><img src="img/island/island_14.png" alt="市政島"></a></div>
      <div class="island"><div class="title">實驗島</div><div class="level">LV3</div><a href="i_15_lab.html"><img src="img/island/island_15.png" alt="實驗島"></a></div>
      <div class="island"><div class="title">銀行島</div><div class="level">LV27</div><a href="i_16_bank.html"><img src="img/island/island_16.png" alt="銀行島"></a></div>
      <div class="island"><div class="title">工程島</div><div class="level">LV5</div><a href="i_17_engineerfirm.html"><img src="img/island/island_17.png" alt="工程島"></a></div>
      <div class="island"><div class="title">電視島</div><div class="level">LV21</div><a href="i_18_tvstation.html"><img src="img/island/island_18.png" alt="電視島"></a></div>
      <div class="island"><div class="title">藝文島</div><div class="level">LV10</div><a href="i_19_artcenter.html"><img src="img/island/island_19.png" alt="藝文島"></a></div>
      <div class="island"><div class="title">醫院島</div><div class="level">LV50</div><a href="i_20_hospital.html"><img src="img/island/island_20.png" alt="醫院島"></a></div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="box">
      <button class="close" id="modalClose">✕</button>
      <h2>玩法說明</h2>
      <ol>
        <li>TOEIC 單字依照類別分成 20 個小島，點選小島進行拼字遊戲。</li>
        <li>每次 4 個單字，答對 1 字 25 分。</li>
        <li>使用提示會扣 1 分。</li>
        <li>完成可得到元素晶石，用來提升小島等級（每 10 級進化，最高 50）。</li>
      </ol>
    </div>
  </div>

<script>
  const avatarInput=document.getElementById('avatarInput');
  const avatarImg=document.getElementById('avatarImg');
  const playerNameEl=document.getElementById('playerName');

  // 初始化：讀取 localStorage
  window.addEventListener('load',()=>{
    const savedName=localStorage.getItem('playerName');
    if(savedName) playerNameEl.textContent=savedName;
    const savedAvatar=localStorage.getItem('playerAvatar');
    if(savedAvatar) avatarImg.src=savedAvatar;
  });

  // 頭像上傳
  avatarInput.addEventListener('change',e=>{
    const file=e.target.files[0];
    if(!file) return;
    if(file.size>2*1024*1024){
      alert('檔案超過 2MB，請重新選擇');
      avatarInput.value='';
      return;
    }
    const reader=new FileReader();
    reader.onload=function(ev){
      avatarImg.src=ev.target.result;
      localStorage.setItem('playerAvatar',ev.target.result);
    };
    reader.readAsDataURL(file);
  });

  // 玩家更名 (限制12字，超過會警告)
  document.getElementById('renameBtn').addEventListener('click',()=>{
    const current=playerNameEl.textContent;
    const newName=prompt('輸入新名稱 (最多12字)：',current);
    if(newName){
      if(newName.length>12){
        alert('名稱不可超過 12 字');
        return;
      }
      playerNameEl.textContent=newName;
      localStorage.setItem('playerName',newName);
    }
  });

  // Modal
  const modal=document.getElementById('modal');
  document.getElementById('hintBtn').onclick=()=>modal.style.display='flex';
  document.getElementById('modalClose').onclick=()=>modal.style.display='none';
  modal.onclick=e=>{if(e.target===modal) modal.style.display='none';};
</script>
</body>
</html>
